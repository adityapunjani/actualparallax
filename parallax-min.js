(function(b){var c,l,m={imageAttribute:"data-image",container:b("body"),speed:.3,coverRatio:.85,mediaWidth:1600,mediaHeight:900,parallax:!0},g=b(window);c=function(a,c){return{init:function(){this.$imageContainer=b(a);this.settings=b.extend({},m,c);this.image=this.$imageContainer.attr(this.settings.imageAttribute);this.mediaWidth=this.$imageContainer.data("width")||this.settings.mediaWidth;this.mediaHeight=this.$imageContainer.data("height")||this.settings.mediaHeight;this.coverRatio=this.$imageContainer.data("cover-ratio")||
this.settings.coverRatio;this.ticking=!1;if(this.image)this.$scrollingElement=b("<img/>").css({opacity:0}).attr("src",this.image).load(function(){b(this).animate({opacity:1},200)});else throw Error("ReferenceError: data-image attribute is not defined");!0===this.settings.parallax?(this.$scrollerHolder=b("<div/>",{html:this.$imageContainer.html()}).css({top:0,visibility:"hidden",position:"fixed",overflow:"hidden"}).addClass("scroller-container").prependTo(this.settings.container),this.$imageContainer.css("visibility",
"hidden").empty(),this.$scrollingElement.css({position:"absolute",visibility:"hidden",maxWidth:"none"}).prependTo(this.$scrollerHolder)):(this.$imageContainer.css({position:"relative"}),this.$scrollerHolder=this.$imageContainer.css({overflow:"hidden"}),this.$scrollingElement.css({position:"relative",overflow:"hidden"}).prependTo(this.$imageContainer));!0===this.settings.parallax?(this._adjustImgHolderHeights(),this._updatePositions()):this._updateFallbackPositions();this._bindEvents()},_adjustImgHolderHeights:function(){var f=
g.height(),a=g.width(),d=this.coverRatio*f,b,e,c,k,h,d=Math.floor(d);e=Math.floor(f-(f-d)*this.settings.speed);h=Math.round(e/this.mediaHeight*this.mediaWidth);h>=a?a=e:(h=a,a=Math.round(h/this.mediaWidth*this.mediaHeight));b=(e-d)/2;c=(a-e)/2;k=(f-d)/2;e=-(f/k*b)-c;c=d/k*b-c-e;k=f+d;b=-Math.round((a-d)/2);this.$scrollingElement.css({height:a,width:h});this.$imageContainer.height(d);this.$scrollerHolder.css({height:d,width:h});this.scrollingState={winHeight:f,fromY:e,imgTopPos:b,imgHolderHeight:d,
imgScrollingDistance:c,travelDistance:k,holderDistanceFromTop:this.$imageContainer.offset().top-g.scrollTop()}},_bindEvents:function(){var a=this;g.on("resize",function(b){a._adjustImgHolderHeights();!0===a.settings.parallax?a._requestTick():a._updateFallbackPositions()});if(!0===this.settings.parallax)g.on("scroll",function(b){a._requestTick()})},_requestTick:function(){var a=this;this.ticking||(this.ticking=!0,requestAnimationFrame(function(){a._updatePositions()}))},_updatePositions:function(){this.scrollingState.holderDistanceFromTop=
this.$imageContainer.offset().top-g.scrollTop();if(this.scrollingState.holderDistanceFromTop<=this.scrollingState.winHeight&&this.scrollingState.holderDistanceFromTop>=-this.scrollingState.imgHolderHeight){var a=Math.round(this.scrollingState.fromY+this.scrollingState.imgScrollingDistance*(1-(this.scrollingState.holderDistanceFromTop+this.scrollingState.imgHolderHeight)/this.scrollingState.travelDistance));this.$scrollerHolder[0].style[this.settings.transformType]="translate3d(0,"+Math.round(this.scrollingState.holderDistanceFromTop)+
"px, 0)";this.$scrollerHolder[0].style.visibility="visible";this.$scrollingElement[0].style[this.settings.transformType]="translate3d(0,"+a+"px, 0)";this.$scrollingElement[0].style.visibility="visible"}else this.$scrollerHolder[0].style.visibility="hidden",this.$scrollingElement[0].style.visibility="hidden";this.ticking=!1},_updateFallbackPositions:function(){this.$scrollingElement.css({width:"100%",display:"block"})}}};l=function(a){void 0!==document.body.style.MozTransform&&(a.transformType="-moz-transform");
void 0!==document.body.style.webkitTransform&&(a.transformType="-webkit-transform");void 0!==document.body.style.msTransform&&(a.transformType="-ms-transform");void 0!==document.body.style.transform&&(a.transformType="transform");void 0==a.transformType&&(a.parallax=!1)};c.defaults=m;b.fn.parallaxScroll=function(a){l(a);return this.each(function(){(new c(this,a)).init()})}})(jQuery);